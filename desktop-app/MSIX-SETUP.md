# MSIX Package Setup Guide

## ‚úÖ Completed Steps

1. **Certificate Generated**
   - Self-signed certificate created: `CN=FamBudget Team`
   - Certificate thumbprint: `AB0423616D04D866779BA260CFAA4D14A2287078`
   - Certificate exported to: `fambudget-cert.pfx`
   - Password: `FamBudget2024!`

2. **Configuration Updated**
   - Certificate configured in `package.json` under `win.certificateFile`
   - Publisher configured in `appx` section

## üîß Current Status

The MSIX build is encountering a manifest validation error. This is a common issue with AppX/MSIX packages and can be caused by:

1. **Manifest Format Issues**: The XML manifest generated by electron-builder may need additional validation
2. **Missing Assets**: Required logo assets (StoreLogo.png, Square150x150Logo.png, etc.)
3. **Publisher Format**: The publisher string format may need adjustment

## üìã Build Commands

### Build Individual Formats
```bash
npm run build-exe      # NSIS EXE installer (‚úÖ Working)
npm run build-msi      # MSI installer (‚úÖ Working)
npm run build-portable # Portable executable (‚úÖ Working)
npm run build-msix     # MSIX package (‚ö†Ô∏è Needs fix)
```

## üîç Troubleshooting MSIX

### Option 1: Use MakeAppx Validator
```powershell
# Install Windows SDK tools
# Then validate manifest:
MakeAppx.exe validate /f AppxManifest.xml
```

### Option 2: Check Manifest Requirements
The AppxManifest.xml must include:
- Valid Identity with matching Publisher
- Required Capabilities
- Application definition with EntryPoint
- Valid Resources section

### Option 3: Use MSIX Packaging Tool
Download and use the MSIX Packaging Tool from Microsoft Store for easier validation.

## üìù Certificate Information

**Certificate Subject**: `CN=FamBudget Team, O=FamBudget, L=Default, S=Default, C=US`  
**Certificate Location**: Windows Certificate Store (CurrentUser\My)  
**PFX File**: `desktop-app/fambudget-cert.pfx`  
**Password**: `FamBudget2024!`

## üéØ Alternative: Use App Installer

For Microsoft Store distribution, consider using:
- **App Installer** (`.appinstaller`) file format
- Windows Store Developer Account for proper signing
- Azure Code Signing service for enterprise certificates

## ‚úÖ Working Build Formats

All other formats are building successfully:

1. **NSIS EXE** (`FamBudget-3.5.1-x64.exe`) - 927 MB
2. **MSI Installer** (`FamBudget-3.5.1-x64.msi`) - 986 MB  
3. **Portable** (`FamBudget.exe`) - Standalone executable

All files are in: `desktop-app/dist-v3.5.1/`

## üîê Production Certificate

For production MSIX packages submitted to Microsoft Store:

1. **Obtain Code Signing Certificate**
   - Purchase from trusted CA (DigiCert, GlobalSign, etc.)
   - Or use Microsoft Partner Center certificate

2. **Update Configuration**
   ```json
   "win": {
     "certificateFile": "./path-to-production-cert.pfx",
     "certificatePassword": "your-secure-password"
   },
   "appx": {
     "publisher": "CN=Your Actual Company Name"
   }
   ```

3. **Trust Certificate** (for testing)
   ```powershell
   Import-Certificate -FilePath "fambudget-cert.pfx" -CertStoreLocation Cert:\LocalMachine\Root
   ```

## üìö Resources

- [Electron Builder AppX Documentation](https://www.electron.build/configuration/appx)
- [MSIX Packaging Guide](https://learn.microsoft.com/en-us/windows/msix/packaging-tool/)
- [Code Signing Certificates](https://learn.microsoft.com/en-us/windows/msix/package/create-certificate-package-signing)

